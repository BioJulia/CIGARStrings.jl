<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · CIGARStrings.jl</title><meta name="title" content="Reference · CIGARStrings.jl"/><meta property="og:title" content="Reference · CIGARStrings.jl"/><meta property="twitter:title" content="Reference · CIGARStrings.jl"/><meta name="description" content="Documentation for CIGARStrings.jl."/><meta property="og:description" content="Documentation for CIGARStrings.jl."/><meta property="twitter:description" content="Documentation for CIGARStrings.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CIGARStrings.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CIGARStrings.jl-reference"><a class="docs-heading-anchor" href="#CIGARStrings.jl-reference">CIGARStrings.jl reference</a><a id="CIGARStrings.jl-reference-1"></a><a class="docs-heading-anchor-permalink" href="#CIGARStrings.jl-reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGAR-reference" href="#CIGARStrings.CIGAR-reference"><code>CIGARStrings.CIGAR</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGAR &lt;: AbstractCIGAR</code></pre><p>A CIGAR string represents the sequence of insertions, matches and deletions that comprise a pairwise alignment. Construct a <code>CIGAR</code> from any object <code>x</code> where <code>MemoryView(x)</code> returns a <code>MemoryView{UInt8}</code>, i.e. any memory-backed bytearray, or string.</p><p>Use <a href="../#CIGARStrings.try_parse"><code>CIGARStrings.try_parse</code></a> to attempt to parse a <code>CIGAR</code> string without throwing an exception if the data is invalid.</p><p>See also: <a href="../#CIGARStrings.CIGARElement"><code>CIGARElement</code></a></p><p><strong>Extended help</strong></p><p>CIGAR strings are sequences of <code>CIGARElement</code>, from the 5&#39; to the 3&#39; of the query (or N- to C-terminal for amino acids). CIGAR strings comprise the entire query, i.e. the sum of lengths of elements with the <code>XMI=SH</code> operations equals the length of the query.</p><p>For example, the query <code>AGCGTAGCACACC</code> that aligns from query base 5 and ref base 1002, like this:</p><pre><code class="language-julia hljs">Q: 5    TAG--CACACC   13
R: 1002 TAGGACAC-CC 1011</code></pre><p>Is summarized by the CIGAR <code>4S3M2D3M1I2M</code>. The operations <code>HX=PN</code> are more rarely used, see <a href="../#CIGARStrings.CIGAROp"><code>CIGAROp</code></a> for a description of the operations.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGARElement-reference" href="#CIGARStrings.CIGARElement-reference"><code>CIGARStrings.CIGARElement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGARElement(op::CIGAROp, len::Integer)</code></pre><p>Type representing a single element in a CIGAR string, consisting of a <code>CIGAROp</code> and a length. For example, in <code>15S198M1D15M</code>, the four elements are <code>15S</code>, <code>198M</code>, <code>1D</code>, and <code>15M</code>. Access the operation and the length with the properties <code>.op</code> and <code>.len</code>. Note that currently, the largest supported length is 268435455. Operations cannot have length zero.</p><p>See also: <a href="../#CIGARStrings.CIGAR"><code>CIGAR</code></a>, <a href="../#CIGARStrings.CIGAROp"><code>CIGAROp</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; e = CIGARElement(OP_X, 3)
CIGARElement(OP_X, 3)

julia&gt; e.len
3

julia&gt; e.op
OP_X</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGAROp-reference" href="#CIGARStrings.CIGAROp-reference"><code>CIGARStrings.CIGAROp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGAROp</code></pre><p>1-byte primitive type representing a CIGAR operation. Module-level constants for each value of this type are exported, e.g. <code>OP_M</code>.</p><p>A <code>CIGAROp</code> is guaranteed to be a 1-byte primitive with the same bitwise representation as a <code>UInt8</code> with the value given as <code>N</code> in the table below, e.g. <code>reinterpret(UInt8, OP_I) === 0x01</code>.</p><p>The <code>Consumes</code> entry below signifies if the operation advances the position in the query (<code>Q</code>), the reference (<code>R</code>) and the alignment (<code>A</code>). E.g. if the <code>CIGARElement</code> <code>9D</code> begins at query, ref, aln positions <code>(A, B, C)</code>, then the positions are <code>(A, B+9, C+9)</code> after. </p><table><tr><th style="text-align: left">N</th><th style="text-align: left">Consumes</th><th style="text-align: left">Variable</th><th style="text-align: left">Char</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">0</td><td style="text-align: left"><code>Q R A</code></td><td style="text-align: left"><code>OP_M</code></td><td style="text-align: left">M</td><td style="text-align: left">Alignment match or mismatch</td></tr><tr><td style="text-align: left">1</td><td style="text-align: left"><code>Q   A</code></td><td style="text-align: left"><code>OP_I</code></td><td style="text-align: left">I</td><td style="text-align: left">Insertion relative to the reference</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left"><code>R A</code></td><td style="text-align: left"><code>OP_D</code></td><td style="text-align: left">D</td><td style="text-align: left">Deletion relative to the reference</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left"><code>R</code></td><td style="text-align: left"><code>OP_N</code></td><td style="text-align: left">N</td><td style="text-align: left">Reference skipped from the alignment (usually an intron)</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left"><code>Q</code></td><td style="text-align: left"><code>OP_S</code></td><td style="text-align: left">S</td><td style="text-align: left">Soft clip (semantically identical to hard clip)</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left"><code>Q</code></td><td style="text-align: left"><code>OP_H</code></td><td style="text-align: left">H</td><td style="text-align: left">Hard clip (semantically identical to soft clip)</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left"><code></code></td><td style="text-align: left"><code>OP_P</code></td><td style="text-align: left">P</td><td style="text-align: left">Padding, position not present in query or reference</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left"><code>Q R A</code></td><td style="text-align: left"><code>OP_Eq</code></td><td style="text-align: left">=</td><td style="text-align: left">Alignment match, not mismatch</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left"><code>Q R A</code></td><td style="text-align: left"><code>OP_X</code></td><td style="text-align: left">X</td><td style="text-align: left">Alignment mismatch</td></tr></table><p>See also: <a href="../#CIGARStrings.CIGARElement"><code>CIGARElement</code></a></p><p><strong>Extended help</strong></p><ul><li><code>M</code> means a match or a mismatch. By default, most programs will emit <code>M</code> instead of <code>X</code> or <code>=</code>, since the important part of the CIGAR is where the insertions and deletions are placed. To determine which bases in an <code>M</code> are matches and mismatches, the two sequences can be compared, base-wise.</li><li><code>N</code> means that the region is spans an intron, which means the query sequence is deleted, but not due to an actual deletion (which would be a <code>D</code> operation). It can also be used for other uses where the reference bases is missing for another reason than a deletion, if such a use case is found.</li><li><code>S</code> and <code>H</code> are semantically identical. They both signify the end(s) of the query sequence which are not part of the alignment. They differ only in whether the clipped bases are written in the SEQ field of a SAM record. Typically, hard-clipped bases are present as soft clipped bases in another record, such that writing them in both records would be wasteful.</li><li><code>P</code> is only used for a multiple sequence alignment. If a third sequence contains an insertion relative to both the query and the reference, the query has a <code>P</code> at this position, indicating it&#39;s present in neither the query nor reference.</li><li>Most alignments only contain the operations <code>M</code>, <code>I</code>, <code>D</code>, <code>S</code>.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.Translation-reference" href="#CIGARStrings.Translation-reference"><code>CIGARStrings.Translation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Translation(kind::TranslationKind, pos::Int)</code></pre><p>The result of translating from a position in the coordinate system of the  query / reference / alignment to a position in one of the others. This type contains two documented properies: <code>kind::TranslationKind</code> and <code>pos::Int</code>.</p><ul><li>If the resulting position is outside the target coordinate, <code>.kind == outside</code> and <code>pos == 0</code></li><li>If the position maps to a non-gap symbol in the other coodinate system, <code>.kind == pos</code>, and the position is the <code>pos</code>&#39;d symbol in the target coordinate system.</li><li>If the position maps to a gap, <code>pos</code> is the position of the symbol before the gap, and <code>kind == gap</code>. When translating to the <code>aln</code> coordinate system, the kind is never <code>gap</code>.</li></ul><p>See also: <a href="../#CIGARStrings.TranslationKind"><code>CIGARStrings.TranslationKind</code></a></p><p><strong>Examples:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;2M3D2M2I1M&quot;);

julia&gt; for i in 0:8
           refpos = query_to_ref(c, i)
           println(refpos.pos, &#39; &#39;, refpos.kind)
       end
0 outside
1 pos
2 pos
6 pos
7 pos
7 gap
7 gap
8 pos
0 outside</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.TranslationKind-reference" href="#CIGARStrings.TranslationKind-reference"><code>CIGARStrings.TranslationKind</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TranslationKind</code></pre><p>This enum has values <code>outside</code>, <code>pos</code> and <code>gap</code>. It represents the result of translating a position between query, reference and alignment.</p><ul><li>If <code>outside</code>, the input position translates to a position outside the alignment</li><li>If <code>pos</code>, the input position corresponds to a non-gap symbol in the alignment</li><li>If <code>gap</code>, the input position maps to a gap.</li></ul><p>See also: <a href="../#CIGARStrings.Translation"><code>Translation</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGARError-reference" href="#CIGARStrings.CIGARError-reference"><code>CIGARStrings.CIGARError</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGARError</code></pre><p>Exception kind thrown by the package CIGARStrings. <code>CIGARError</code>s contain two properties: <code>.kind</code>, returning a <a href="../#CIGARStrings.Errors.CIGARErrorType"><code>CIGARErrorType</code></a>, and <code>.index</code>, returning an <code>Int</code>, pointing to the approximate byte index where the exception was encountered.</p><p>The <code>kind</code> and <code>pos</code> are stable API, in the sense that e.g. an integer overflow at position 55 will always be represented by a <code>CIGARError(55, CIGARStrings.Errors.IntegerOverflow)</code>. However, the same invalid CIGAR string may produce multiple different errors, and which error is produced in that case <strong>is NOT</strong> stable API, because that depends on specifics parsing internals.</p><pre><code class="language-julia-repl hljs">julia&gt; ce = CIGARStrings.try_parse(CIGAR, &quot;15M9&quot;);

julia&gt; ce.index
4

julia&gt; ce.kind
Truncated::CIGARErrorType = 0x05</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.Errors.CIGARErrorType-reference" href="#CIGARStrings.Errors.CIGARErrorType-reference"><code>CIGARStrings.Errors.CIGARErrorType</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGARErrorType</code></pre><p>Single-byte enum representing the different kind of errors returned or thrown by the package CIGARStrings. This currently implemented list of error kinds is not exhaustive, in that more could be added in minor versions of this package.</p><p>See also: <a href="../#CIGARStrings.CIGARError"><code>CIGARError</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.try_parse-reference" href="#CIGARStrings.try_parse-reference"><code>CIGARStrings.try_parse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">try_parse(::Type{CIGAR}, x)::Union{CIGAR, CIGARError}</code></pre><p>Cast <code>x</code> to a <code>MemoryView{UInt8}</code>, and try parsing a <a href="../#CIGARStrings.CIGAR"><code>CIGAR</code></a> from it. If the parsing is unsuccessful, return a <a href="../#CIGARStrings.CIGARError"><code>CIGARError</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGARStrings.try_parse(CIGAR, &quot;2S1M9I&quot;);

julia&gt; c isa CIGAR # success
true

julia&gt; c = CIGARStrings.try_parse(CIGAR, &quot;1S7H9M1S&quot;);

julia&gt; c.kind
InvalidHardClip::CIGARErrorType = 0x03</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_M" href="#CIGARStrings.OP_M"><code>CIGARStrings.OP_M</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;M&#39;</code>: Alignment match or mismatch</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_I" href="#CIGARStrings.OP_I"><code>CIGARStrings.OP_I</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;I&#39;</code>: Insertion relative to the reference</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_D" href="#CIGARStrings.OP_D"><code>CIGARStrings.OP_D</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;D&#39;</code>: Deletion relative to the reference</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_S" href="#CIGARStrings.OP_S"><code>CIGARStrings.OP_S</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;S&#39;</code>: Soft clip (clipped sequence present in query)</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_H" href="#CIGARStrings.OP_H"><code>CIGARStrings.OP_H</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;H&#39;</code>: Hard clip (clipped sequence not present in query)</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_N" href="#CIGARStrings.OP_N"><code>CIGARStrings.OP_N</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;N&#39;</code>: Region skipped from the reference (usually an intron)</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_P" href="#CIGARStrings.OP_P"><code>CIGARStrings.OP_P</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;P&#39;</code>: Padding</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_X" href="#CIGARStrings.OP_X"><code>CIGARStrings.OP_X</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;X&#39;</code>: Alignment mismatch</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.OP_Eq" href="#CIGARStrings.OP_Eq"><code>CIGARStrings.OP_Eq</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>&#39;=&#39;</code>: Alignment match, not mismatch</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.PositionMapper" href="#CIGARStrings.PositionMapper"><code>CIGARStrings.PositionMapper</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PositionMapper{Params...}</code></pre><p>Public struct returned by <code>pos_to_pos(..., pos)</code> when <code>!isa(pos, Integer)</code>. This type may be referred to in stable code, but its API is defined by <code>pos_to_pos</code></p><p>See also: <a href="../#CIGARStrings.pos_to_pos"><code>pos_to_pos</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.query" href="#CIGARStrings.query"><code>CIGARStrings.query</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Coordinate system representing the 1-based index in the query sequence</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.ref" href="#CIGARStrings.ref"><code>CIGARStrings.ref</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Coordinate system representing the 1-based index in the reference sequence</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.aln" href="#CIGARStrings.aln"><code>CIGARStrings.aln</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Coordinate system representing the 1-based index in the alignment (i.e. query/ref including gaps)</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.ref_length" href="#CIGARStrings.ref_length"><code>CIGARStrings.ref_length</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ref_length(::AbstractCIGAR)::Int</code></pre><p>Get the number of biosymbols in the reference of the <code>CIGAR</code>. This is the same as the lengths of all <code>CIGARElement</code>s of type <code>M</code>, <code>D</code>, <code>N</code>, <code>=</code> and <code>X</code>.</p><p>See also: <a href="#CIGARStrings.query_length"><code>query_length</code></a>, <a href="#CIGARStrings.aln_length"><code>aln_length</code></a></p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; ref_length(CIGAR(&quot;1S5M2D6M2I5M&quot;))
18</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.query_length" href="#CIGARStrings.query_length"><code>CIGARStrings.query_length</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">query_length(::AbstractCIGAR)::Int</code></pre><p>Get the number of biosymbols in the query of the <code>CIGAR</code>. This is the same as the lengths of all <code>CIGARElement</code>s of type <code>M</code>, <code>I</code>, <code>S</code>, <code>H</code>, <code>=</code> and <code>X</code>.</p><p>See also: <a href="#CIGARStrings.ref_length"><code>ref_length</code></a>, <a href="#CIGARStrings.aln_length"><code>aln_length</code></a></p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; query_length(CIGAR(&quot;1S5M2D6M2I5M&quot;))
19</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.aln_length" href="#CIGARStrings.aln_length"><code>CIGARStrings.aln_length</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aln_length(::AbstractCIGAR)::Int</code></pre><p>Get the number of biosymbols spanned by the alignment of the <code>CIGAR</code>. Clips, padding and skips are not part of the alignment, but still part of the CIGAR. Therefore, the alignment length is the same as the lengths of all <code>CIGARElement</code>s of type <code>M</code>, <code>I</code>, <code>D</code>, <code>=</code> and <code>X</code>.</p><p>See also: <a href="#CIGARStrings.query_length"><code>query_length</code></a>, <a href="#CIGARStrings.ref_length"><code>ref_length</code></a></p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; aln_length(CIGAR(&quot;1S5M2D6M2I5M&quot;))
20</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.aln_identity" href="#CIGARStrings.aln_identity"><code>CIGARStrings.aln_identity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aln_identity(::AbstractCIGAR, mismatches::Int)::Float64</code></pre><p>Compute the alignment identity of the <code>CIGAR</code>, computed as the number of matches (not mismatches) divided by alignment length. Since the CIGAR itself may not provide information about the precise number of mismatches, the amount of mismatches is an argument. The result is always in [0.0, 1.0].</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; aln_identity(CIGAR(&quot;3M1D3M1I2M&quot;), 2)
0.6</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.query_to_ref" href="#CIGARStrings.query_to_ref"><code>CIGARStrings.query_to_ref</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">query_to_ref(x::AbstractCIGAR, pos::Integer)::Int</code></pre><p>Get the 1-based reference position aligning to query position <code>pos</code>. See <a href="../#CIGARStrings.Translation"><code>Translation</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;3M2D1M4I2M&quot;);

julia&gt; query_to_ref(c, 4)
Translation(pos, 6)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.query_to_aln" href="#CIGARStrings.query_to_aln"><code>CIGARStrings.query_to_aln</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">query_to_aln(x::AbstractCIGAR, pos::Integer)::Int</code></pre><p>Get the 1-based alignment position aligning to query position <code>pos</code>. See <a href="../#CIGARStrings.Translation"><code>Translation</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;3M2D1M4I2M&quot;);

julia&gt; query_to_aln(c, 8)
Translation(pos, 10)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.ref_to_query" href="#CIGARStrings.ref_to_query"><code>CIGARStrings.ref_to_query</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ref_to_query(x::AbstractCIGAR, pos::Integer)::Int</code></pre><p>Get the 1-based query position aligning to reference position <code>pos</code>. See <a href="../#CIGARStrings.Translation"><code>Translation</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;3M2D1M4I2M&quot;);

julia&gt; ref_to_query(c, 7)
Translation(pos, 9)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.ref_to_aln" href="#CIGARStrings.ref_to_aln"><code>CIGARStrings.ref_to_aln</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ref_to_aln(x::AbstractCIGAR, pos::Integer)::Int</code></pre><p>Get the 1-based alignment position aligning to reference position <code>pos</code>. See <a href="../#CIGARStrings.Translation"><code>Translation</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;3M2D1M4I2M&quot;);

julia&gt; ref_to_aln(c, 7)
Translation(pos, 11)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.aln_to_query" href="#CIGARStrings.aln_to_query"><code>CIGARStrings.aln_to_query</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aln_to_query(x::AbstractCIGAR, pos::Integer)::Int</code></pre><p>Get the 1-based query position aligning to alignment position <code>pos</code>. See <a href="../#CIGARStrings.Translation"><code>Translation</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;3M2D1M4I2M&quot;);

julia&gt; aln_to_query(c, 10)
Translation(pos, 8)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.aln_to_ref" href="#CIGARStrings.aln_to_ref"><code>CIGARStrings.aln_to_ref</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aln_to_ref(x::AbstractCIGAR, pos::Integer)::Int</code></pre><p>Get the 1-based reference position aligning to alignment position <code>pos</code>. See <a href="../#CIGARStrings.Translation"><code>Translation</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;3M2D1M4I2M&quot;);

julia&gt; aln_to_ref(c, 9)
Translation(gap, 6)</code></pre></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 4 September 2025 07:14">Thursday 4 September 2025</span>. Using Julia version 1.13.0-DEV.1080.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

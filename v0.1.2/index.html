<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · CIGARStrings.jl</title><meta name="title" content="Home · CIGARStrings.jl"/><meta property="og:title" content="Home · CIGARStrings.jl"/><meta property="twitter:title" content="Home · CIGARStrings.jl"/><meta name="description" content="Documentation for CIGARStrings.jl."/><meta property="og:description" content="Documentation for CIGARStrings.jl."/><meta property="twitter:description" content="Documentation for CIGARStrings.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>CIGARStrings.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Individual-alignment-operations"><span>Individual alignment operations</span></a></li><li><a class="tocitem" href="#CIGARs"><span>CIGARs</span></a></li><li><a class="tocitem" href="#Position-translation"><span>Position translation</span></a></li><li><a class="tocitem" href="#Errors-and-error-recovery"><span>Errors and error recovery</span></a></li><li><a class="tocitem" href="#bamcigar"><span>The BAMCIGAR type</span></a></li></ul></li><li><a class="tocitem" href="reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CIGARStrings.jl"><a class="docs-heading-anchor" href="#CIGARStrings.jl">CIGARStrings.jl</a><a id="CIGARStrings.jl-1"></a><a class="docs-heading-anchor-permalink" href="#CIGARStrings.jl" title="Permalink"></a></h1><p>CIGARStrings.jl provide functionality for parsing and working with Concise Idiosyncratic Gapped Alignment Report - or CIGAR - strings. CIGARs were popularized by the <a href="https://en.wikipedia.org/wiki/SAM_(file_format)">SAM format</a>, and are a compact run length encoding notation to represent pairwise alignments. They can be found in the SAM, BAM, PAF, and GFA formats.</p><p>For example, the following pairwise alignment of a query to a reference:</p><pre><code class="nohighlight hljs">    Q: TAGAT---TAGCTAC
       ||||    ||  | |
    R: TAGAACCATA--TGC</code></pre><p>Can be represented by the CIGAR <code>5M3D2M2I3M</code>, representing:</p><ol><li>5 matches/mismatches</li><li>Then, 3 deletions</li><li>Then, 2 matches/mismatches</li><li>Then, 2 insertions</li><li>Finally, 3 matches/mismatches.</li></ol><p>A CIGAR strings is always written in terms of the <em>query</em>, and not the reference. </p><h2 id="Individual-alignment-operations"><a class="docs-heading-anchor" href="#Individual-alignment-operations">Individual alignment operations</a><a id="Individual-alignment-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Individual-alignment-operations" title="Permalink"></a></h2><p>One run of identical alignment operations, e.g. &quot;5 matches/mismatches&quot; are represented by a single <code>CIGARElement</code>. Conceptually, a <code>CIGARElement</code> is an alignment operation (represented by a <code>CIGAROp</code>) and a length:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGARElement" href="#CIGARStrings.CIGARElement"><code>CIGARStrings.CIGARElement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGARElement(op::CIGAROp, len::Integer)</code></pre><p>Type representing a single element in a CIGAR string, consisting of a <code>CIGAROp</code> and a length. For example, in <code>15S198M1D15M</code>, the four elements are <code>15S</code>, <code>198M</code>, <code>1D</code>, and <code>15M</code>. Access the operation and the length with the properties <code>.op</code> and <code>.len</code>. Note that currently, the largest supported length is 268435455. Operations cannot have length zero.</p><p>See also: <a href="#CIGARStrings.CIGAR"><code>CIGAR</code></a>, <a href="#CIGARStrings.CIGAROp"><code>CIGAROp</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; e = CIGARElement(OP_X, 3)
CIGARElement(OP_X, 3)

julia&gt; e.len
3

julia&gt; e.op
OP_X</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGAROp" href="#CIGARStrings.CIGAROp"><code>CIGARStrings.CIGAROp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGAROp</code></pre><p>1-byte primitive type representing a CIGAR operation. Module-level constants for each value of this type are exported, e.g. <code>OP_M</code>.</p><p>A <code>CIGAROp</code> is guaranteed to be a 1-byte primitive with the same bitwise representation as a <code>UInt8</code> with the value given as <code>N</code> in the table below, e.g. <code>reinterpret(UInt8, OP_I) === 0x01</code>.</p><p>The <code>Consumes</code> entry below signifies if the operation advances the position in the query (<code>Q</code>), the reference (<code>R</code>) and the alignment (<code>A</code>). E.g. if the <code>CIGARElement</code> <code>9D</code> begins at query, ref, aln positions <code>(A, B, C)</code>, then the positions are <code>(A, B+9, C+9)</code> after. </p><table><tr><th style="text-align: left">N</th><th style="text-align: left">Consumes</th><th style="text-align: left">Variable</th><th style="text-align: left">Char</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">0</td><td style="text-align: left"><code>Q R A</code></td><td style="text-align: left"><code>OP_M</code></td><td style="text-align: left">M</td><td style="text-align: left">Alignment match or mismatch</td></tr><tr><td style="text-align: left">1</td><td style="text-align: left"><code>Q   A</code></td><td style="text-align: left"><code>OP_I</code></td><td style="text-align: left">I</td><td style="text-align: left">Insertion relative to the reference</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left"><code>R A</code></td><td style="text-align: left"><code>OP_D</code></td><td style="text-align: left">D</td><td style="text-align: left">Deletion relative to the reference</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left"><code>R</code></td><td style="text-align: left"><code>OP_N</code></td><td style="text-align: left">N</td><td style="text-align: left">Reference skipped from the alignment (usually an intron)</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left"><code>Q</code></td><td style="text-align: left"><code>OP_S</code></td><td style="text-align: left">S</td><td style="text-align: left">Soft clip (semantically identical to hard clip)</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left"><code>Q</code></td><td style="text-align: left"><code>OP_H</code></td><td style="text-align: left">H</td><td style="text-align: left">Hard clip (semantically identical to soft clip)</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left"><code></code></td><td style="text-align: left"><code>OP_P</code></td><td style="text-align: left">P</td><td style="text-align: left">Padding, position not present in query or reference</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left"><code>Q R A</code></td><td style="text-align: left"><code>OP_Eq</code></td><td style="text-align: left">=</td><td style="text-align: left">Alignment match, not mismatch</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left"><code>Q R A</code></td><td style="text-align: left"><code>OP_X</code></td><td style="text-align: left">X</td><td style="text-align: left">Alignment mismatch</td></tr></table><p>See also: <a href="#CIGARStrings.CIGARElement"><code>CIGARElement</code></a></p><p><strong>Extended help</strong></p><ul><li><code>M</code> means a match or a mismatch. By default, most programs will emit <code>M</code> instead of <code>X</code> or <code>=</code>, since the important part of the CIGAR is where the insertions and deletions are placed. To determine which bases in an <code>M</code> are matches and mismatches, the two sequences can be compared, base-wise.</li><li><code>N</code> means that the region is spans an intron, which means the query sequence is deleted, but not due to an actual deletion (which would be a <code>D</code> operation). It can also be used for other uses where the reference bases is missing for another reason than a deletion, if such a use case is found.</li><li><code>S</code> and <code>H</code> are semantically identical. They both signify the end(s) of the query sequence which are not part of the alignment. They differ only in whether the clipped bases are written in the SEQ field of a SAM record. Typically, hard-clipped bases are present as soft clipped bases in another record, such that writing them in both records would be wasteful.</li><li><code>P</code> is only used for a multiple sequence alignment. If a third sequence contains an insertion relative to both the query and the reference, the query has a <code>P</code> at this position, indicating it&#39;s present in neither the query nor reference.</li><li>Most alignments only contain the operations <code>M</code>, <code>I</code>, <code>D</code>, <code>S</code>.</li></ul></div></section></article><h2 id="CIGARs"><a class="docs-heading-anchor" href="#CIGARs">CIGARs</a><a id="CIGARs-1"></a><a class="docs-heading-anchor-permalink" href="#CIGARs" title="Permalink"></a></h2><p>A CIGAR string is represented by an <code>AbstractCIGAR</code>, which currently has two subtypes: <code>CIGAR</code> and <code>BAMCIGAR</code>. These types differ in their memory layout: The former stores the CIGAR as its ASCII representation (as used in the SAM format), and the latter stores it in a binary format (as used in the BAM format). Both typs store its underlying data as an <code>ImmutableMemoryView{UInt8}</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.AbstractCIGAR" href="#CIGARStrings.AbstractCIGAR"><code>CIGARStrings.AbstractCIGAR</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractCIGAR</code></pre><p>This abstract type is (not yet) a defined interface. Its concrete subtypes are <code>CIGAR</code> and <code>BAMCIGAR</code>.</p></div></section></article><p>The API for these two types are almost interchangeable, so examples below will use <code>CIGAR</code>, since its plaintext representation makes examples easier. See <a href="#bamcigar">BAMCIGAR section</a> for a list of all differences between the two types.</p><p>CIGAR strings are validated upon construction</p><pre><code class="language-julia-repl hljs">julia&gt; CIGAR(&quot;2M1D3M&quot;)
CIGAR(&quot;2M1D3M&quot;)

julia&gt; CIGAR(&quot;1M1W1S&quot;)
ERROR: Error around byte 4: Invalid operation. Possible values are &quot;MIDNSHP=X&quot;.
[...]</code></pre><p>Since CIGAR strings occur in various bioinformatics file formats, it is expected that users of CIGARStrings.jl will construct <code>CIGAR</code>s from a view into a buffer storing a chunk of the file.</p><p>This is zero-copy, and <em>ought</em> not to allocate (although it currently does, due to <a href="https://github.com/JuliaLang/julia/issues/53584">a limitation of the Julia compiler</a>):</p><p>For example:</p><pre><code class="language-julia-repl hljs">julia&gt; data = b&quot;some format with CIGAR: 15M9D18M etc&quot;;

julia&gt; buffer = collect(data);

julia&gt; c = CIGAR(view(buffer, 25:32))
CIGAR(&quot;15M9D18M&quot;)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGAR" href="#CIGARStrings.CIGAR"><code>CIGARStrings.CIGAR</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGAR &lt;: AbstractCIGAR</code></pre><p>A CIGAR string represents the sequence of insertions, matches and deletions that comprise a pairwise alignment. Construct a <code>CIGAR</code> from any object <code>x</code> where <code>MemoryView(x)</code> returns a <code>MemoryView{UInt8}</code>, i.e. any memory-backed bytearray, or string.</p><p>Use <a href="#CIGARStrings.try_parse"><code>CIGARStrings.try_parse</code></a> to attempt to parse a <code>CIGAR</code> string without throwing an exception if the data is invalid.</p><p>See also: <a href="#CIGARStrings.CIGARElement"><code>CIGARElement</code></a></p><p><strong>Extended help</strong></p><p>CIGAR strings are sequences of <code>CIGARElement</code>, from the 5&#39; to the 3&#39; of the query (or N- to C-terminal for amino acids). CIGAR strings comprise the entire query, i.e. the sum of lengths of elements with the <code>XMI=SH</code> operations equals the length of the query.</p><p>For example, the query <code>AGCGTAGCACACC</code> that aligns from query base 5 and ref base 1002, like this:</p><pre><code class="language-julia hljs">Q: 5    TAG--CACACC   13
R: 1002 TAGGACAC-CC 1011</code></pre><p>Is summarized by the CIGAR <code>4S3M2D3M1I2M</code>. The operations <code>HX=PN</code> are more rarely used, see <a href="#CIGARStrings.CIGAROp"><code>CIGAROp</code></a> for a description of the operations.</p></div></section></article><p><code>CIGAR</code>s are iterable, and returns its <code>CIGARElement</code>s, in order:</p><pre><code class="language-julia-repl hljs">julia&gt; collect(CIGAR(&quot;2M1D3M&quot;))
3-element Vector{CIGARElement}:
 CIGARElement(OP_M, 2)
 CIGARElement(OP_D, 1)
 CIGARElement(OP_M, 3)</code></pre><p>They can be converted back to strings using <code>string(::CIGAR)</code>, or printed into an <code>IO</code>, in which case their normal string representation is recovered:</p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;2M1D3M&quot;);

julia&gt; string(c)
&quot;2M1D3M&quot;

julia&gt; io = IOBuffer(); print(io, c); String(take!(io))
&quot;2M1D3M&quot;</code></pre><p>The memory underlying the CIGAR types can be obtained with <code>MemoryView(x)</code> using the MemoryViews.jl package:</p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;19M&quot;);

julia&gt; println(MemoryView(c))
UInt8[0x31, 0x39, 0x4d]

julia&gt; println(MemoryView(BAMCIGAR(c)))
UInt8[0x30, 0x01, 0x00, 0x00]</code></pre><h3 id="Basic-information-about-a-CIGAR"><a class="docs-heading-anchor" href="#Basic-information-about-a-CIGAR">Basic information about a CIGAR</a><a id="Basic-information-about-a-CIGAR-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-information-about-a-CIGAR" title="Permalink"></a></h3><p>The reference, query and alignment length can be obtained with the functions <a href="reference/#CIGARStrings.ref_length"><code>ref_length</code></a>, <a href="reference/#CIGARStrings.query_length"><code>query_length</code></a> and <a href="reference/#CIGARStrings.aln_length"><code>aln_length</code></a>.</p><p>In the alignment below, represented as <code>5M3D2M2I3M</code>, the query length is 12, since there are 12 query symbols, the reference length is 13, and the alignment length is 15.</p><pre><code class="nohighlight hljs">    Q: TAGAT---TAGCTAC
       ||||    ||  | |
    R: TAGAACCATA--TGC</code></pre><p>We always have <code>aln_length(c) ≥ max(query_length(c), ref_length(c))</code></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;5M3D2M2I3M&quot;);

julia&gt; ref_length(c)
13

julia&gt; query_length(c)
12

julia&gt; aln_length(c)
15</code></pre><p>The alignment identity (number of matches, not mismatches divided by alignment length) can be obtained with <a href="reference/#CIGARStrings.aln_identity"><code>aln_identity</code></a>. Since the number of mismatches may not be known from the CIGAR itself (i.e. &quot;100M&quot; could have anywhere from 0 to 100 mismatches), the mismatches is passed in as an argument:</p><pre><code class="language-julia-repl hljs">julia&gt; aln_identity(CIGAR(&quot;3M1D3M1I2M&quot;), 2)
0.6</code></pre><h2 id="Position-translation"><a class="docs-heading-anchor" href="#Position-translation">Position translation</a><a id="Position-translation-1"></a><a class="docs-heading-anchor-permalink" href="#Position-translation" title="Permalink"></a></h2><p>Sometimes it may be necessary to answer questions of the form &quot;which reference position does query position 8 align to?&quot;.</p><p>As an example, consider the alignment below. The query position (QP), reference position (RP) and alignment position (AP) are also written in this alignment.</p><pre><code class="nohighlight hljs">    QP:12345   6789012

    Q: TAGAT---TAGCTAC
       ||||    ||  | |
    R: TAGAACCATA--TGC

    RP:1234567890  123
    AP:123456789012345</code></pre><p>We can see that query position 6 aligns to reference position 9, which is also alignment position 9.</p><p>These position translations can be obtained using the functions <a href="reference/#CIGARStrings.query_to_ref"><code>query_to_ref</code></a>, <a href="reference/#CIGARStrings.query_to_aln"><code>query_to_aln</code></a>, <a href="reference/#CIGARStrings.ref_to_query"><code>ref_to_query</code></a>, <a href="reference/#CIGARStrings.ref_to_aln"><code>ref_to_aln</code></a>, <a href="reference/#CIGARStrings.aln_to_query"><code>aln_to_query</code></a> and <a href="reference/#CIGARStrings.aln_to_ref"><code>aln_to_ref</code></a>. They return a <code>Translation</code> object that contains two properties: <code>.pos</code> and <code>.kind</code>.</p><p>When a position translation has a straightforward answer, the <code>.kind</code> property is <code>CIGARStrings.pos</code>, and the <code>.pos</code> field is the corresponding position:</p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;4M3D2M2I3M&quot;); # alignment above

julia&gt; query_to_ref(c, 6)
Translation(pos, 9)

julia&gt; aln_to_query(c, 9)
Translation(pos, 6)</code></pre><p>Note that these operations are in <strong>linear time</strong>, as they scan the CIGAR string from the beginning. If the CIGAR string is long, and many of these operations are done on the same string, it may be better to construct another data structure for the alignment, which allows logarithmic-time queries, e.g. the ones in BioAlignments.jl.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.Translation" href="#CIGARStrings.Translation"><code>CIGARStrings.Translation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Translation(kind::TranslationKind, pos::Int)</code></pre><p>The result of translating from a position in the coordinate system of the  query / reference / alignment to a position in one of the others. This type contains two documented properies: <code>kind::TranslationKind</code> and <code>pos::Int</code>.</p><ul><li>If the resulting position is outside the target coordinate, <code>.kind == outside</code> and <code>pos == 0</code></li><li>If the position maps to a non-gap symbol in the other coodinate system, <code>.kind == pos</code>, and the position is the <code>pos</code>&#39;d symbol in the target coordinate system.</li><li>If the position maps to a gap, <code>pos</code> is the position of the symbol before the gap, and <code>kind == gap</code>. When translating to the <code>aln</code> coordinate system, the kind is never <code>gap</code>.</li></ul><p>See also: <a href="#CIGARStrings.TranslationKind"><code>CIGARStrings.TranslationKind</code></a></p><p><strong>Examples:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;2M3D2M2I1M&quot;);

julia&gt; for i in 0:8
           refpos = query_to_ref(c, i)
           println(refpos.pos, &#39; &#39;, refpos.kind)
       end
0 outside
1 pos
2 pos
6 pos
7 pos
7 gap
7 gap
8 pos
0 outside</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.TranslationKind" href="#CIGARStrings.TranslationKind"><code>CIGARStrings.TranslationKind</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TranslationKind</code></pre><p>This enum has values <code>outside</code>, <code>pos</code> and <code>gap</code>. It represents the result of translating a position between query, reference and alignment.</p><ul><li>If <code>outside</code>, the input position translates to a position outside the alignment</li><li>If <code>pos</code>, the input position corresponds to a non-gap symbol in the alignment</li><li>If <code>gap</code>, the input position maps to a gap.</li></ul><p>See also: <a href="#CIGARStrings.Translation"><code>Translation</code></a></p></div></section></article><h2 id="Errors-and-error-recovery"><a class="docs-heading-anchor" href="#Errors-and-error-recovery">Errors and error recovery</a><a id="Errors-and-error-recovery-1"></a><a class="docs-heading-anchor-permalink" href="#Errors-and-error-recovery" title="Permalink"></a></h2><p>CIGARStrings.jl allows you to parse a poential CIGAR string without throwing an exception if the data is invalid, using the function <a href="#CIGARStrings.try_parse"><code>CIGARStrings.try_parse</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.CIGARError" href="#CIGARStrings.CIGARError"><code>CIGARStrings.CIGARError</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGARError</code></pre><p>Exception kind thrown by the package CIGARStrings. <code>CIGARError</code>s contain two properties: <code>.kind</code>, returning a <a href="#CIGARStrings.Errors.CIGARErrorType"><code>CIGARErrorType</code></a>, and <code>.index</code>, returning an <code>Int</code>, pointing to the approximate byte index where the exception was encountered.</p><p>The <code>kind</code> and <code>pos</code> are stable API, in the sense that e.g. an integer overflow at position 55 will always be represented by a <code>CIGARError(55, CIGARStrings.Errors.IntegerOverflow)</code>. However, the same invalid CIGAR string may produce multiple different errors, and which error is produced in that case <strong>is NOT</strong> stable API, because that depends on specifics parsing internals.</p><pre><code class="language-julia-repl hljs">julia&gt; ce = CIGARStrings.try_parse(CIGAR, &quot;15M9&quot;);

julia&gt; ce.index
4

julia&gt; ce.kind
Truncated::CIGARErrorType = 0x05</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.Errors.CIGARErrorType" href="#CIGARStrings.Errors.CIGARErrorType"><code>CIGARStrings.Errors.CIGARErrorType</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CIGARErrorType</code></pre><p>Single-byte enum representing the different kind of errors returned or thrown by the package CIGARStrings. This currently implemented list of error kinds is not exhaustive, in that more could be added in minor versions of this package.</p><p>See also: <a href="#CIGARStrings.CIGARError"><code>CIGARError</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.try_parse" href="#CIGARStrings.try_parse"><code>CIGARStrings.try_parse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">try_parse(::Type{CIGAR}, x)::Union{CIGAR, CIGARError}</code></pre><p>Cast <code>x</code> to a <code>MemoryView{UInt8}</code>, and try parsing a <a href="#CIGARStrings.CIGAR"><code>CIGAR</code></a> from it. If the parsing is unsuccessful, return a <a href="#CIGARStrings.CIGARError"><code>CIGARError</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGARStrings.try_parse(CIGAR, &quot;2S1M9I&quot;);

julia&gt; c isa CIGAR # success
true

julia&gt; c = CIGARStrings.try_parse(CIGAR, &quot;1S7H9M1S&quot;);

julia&gt; c.kind
InvalidHardClip::CIGARErrorType = 0x03</code></pre></div></section></article><h2 id="bamcigar"><a class="docs-heading-anchor" href="#bamcigar">The BAMCIGAR type</a><a id="bamcigar-1"></a><a class="docs-heading-anchor-permalink" href="#bamcigar" title="Permalink"></a></h2><p>A CIGAR in the BAM format is stored in an array of 32-bit integers. However, in order to make zero-copy CIGARs possible, the <code>BAMCIGAR</code> type is backed by an <code>ImmutableMemoryView{UInt8}</code> instead, with the same memory layout as its equivalent <code>Memory{UInt32}</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.BAMCIGAR" href="#CIGARStrings.BAMCIGAR"><code>CIGARStrings.BAMCIGAR</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BAMCIGAR &lt;: AbstractCIGAR</code></pre><p>A BAMCIGAR is an alternative representation of a CIGAR, stored compactly in 32-bit integers. Semantically, a BAMCIGAR behaves much similar to a CIGAR.</p><p>Construct a BAMCIGAR either from a CIGAR, taking an optional <code>Vector{UInt8}</code> to use as backing storage, or using <a href="#CIGARStrings.try_parse"><code>CIGARStrings.try_parse</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;9S123M1=3I15M2H&quot;);

julia&gt; b = BAMCIGAR(c, UInt8[]); # use existing storage

julia&gt; c == b
true

julia&gt; CIGAR(b)
CIGAR(&quot;9S123M1=3I15M2H&quot;)</code></pre></div></section></article><p>A <code>BAMCIGAR</code> can be constructed from its binary representation, using any type which implements <code>MemoryViews.MemoryView</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; BAMCIGAR(&quot;\x54\4\0\0\x70\4\0\0&quot;)
BAMCIGAR(CIGAR(&quot;69S71M&quot;))</code></pre><p>This is not zero-cost: Like <code>CIGAR</code> the type contains some metadata and is validated upon construction.</p><p>Like <code>CIGAR</code>, the <code>try_parse</code> function can be used:</p><pre><code class="language-julia-repl hljs">julia&gt; CIGARStrings.try_parse(BAMCIGAR, &quot;\x5f\4\0\0\x70\4\0\0&quot;)
CIGARStrings.CIGARError(1, CIGARStrings.Errors.InvalidOperation)</code></pre><p><code>CIGAR</code> and <code>BAMCIGAR</code> can be converted ifallably to each other:</p><pre><code class="language-julia-repl hljs">julia&gt; c = CIGAR(&quot;6H19S18M1I22=8I2S&quot;);

julia&gt; b = BAMCIGAR(c);

julia&gt; b == c
true

julia&gt; CIGAR(b) == c
true</code></pre><p>Note that printing a <code>BAMCIGAR</code> allocates, because it needs to allocate a new piece of memory to store its ASCII representation. For high performance applications, the function <code>cigar_view!</code> may be used:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CIGARStrings.cigar_view!" href="#CIGARStrings.cigar_view!"><code>CIGARStrings.cigar_view!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cigar_view!(v::Vector{UInt8}, x::BAMCIGAR)::ImmutableMemoryView{UInt8}</code></pre><p>Write the ASCII (i.e. <code>CIGAR</code>) representation <code>x</code> into <code>v</code>, emptying <code>v</code>&#39;s original content. A memory view of <code>v</code> is returned:</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; v = [0x01, 0x02, 0x03];

julia&gt; bc = BAMCIGAR(CIGAR(&quot;151M3D20M&quot;));

julia&gt; mem_view = cigar_view!(v, bc);

julia&gt; mem_view == v
true

julia&gt; String(mem_view) == string(CIGAR(bc))
true</code></pre></div></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 1 September 2025 07:53">Monday 1 September 2025</span>. Using Julia version 1.13.0-DEV.1067.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
